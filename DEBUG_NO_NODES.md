# ğŸ” èª¿è©¦èªªæ˜ - Custom Nodes ä¸é¡¯ç¤º

## å•é¡Œç™¼ç¾

**æ•¸æ“šåº«ä¸­æ²’æœ‰æ•¸æ“š** â†’ é€™æ„å‘³è‘— CREATE mutation æ²’æœ‰æˆåŠŸåŸ·è¡Œï¼

---

## ğŸš¨ é—œéµç™¼ç¾

1. **æ•¸æ“šåº«**: 0 å€‹ custom nodes
2. **Hasura æ—¥èªŒ**: æ²’æœ‰ INSERT è«‹æ±‚è¨˜éŒ„
3. **çµè«–**: å‰ç«¯ mutation å¤±æ•—ï¼Œä½†éŒ¯èª¤è¢«éš±è—äº†

---

## ğŸ”§ ç«‹å³æª¢æŸ¥æ­¥é©Ÿ

### 1. æ‰“é–‹ç€è¦½å™¨é–‹ç™¼è€…å·¥å…· (F12)

### 2. åˆ‡æ›åˆ° Console æ¨™ç±¤

### 3. æ¸…ç©ºæ§åˆ¶å°

### 4. å˜—è©¦å‰µå»ºä¸€å€‹ Custom Node

### 5. è§€å¯Ÿæ§åˆ¶å°è¼¸å‡º

æ‡‰è©²æœƒçœ‹åˆ°é¡ä¼¼é€™æ¨£çš„éŒ¯èª¤ï¼š
```
[handleCreateCustomNode] ...
Failed to create custom node: ...
```

---

## ğŸ“‹ å¯èƒ½çš„éŒ¯èª¤åŸå› 

### A. bytea é¡å‹å•é¡Œ
```
éŒ¯èª¤: Variable "$data" got invalid value ...
åŸå› : Hasura ä¸æ¥å—æˆ‘å€‘çš„ base64 å­—ç¬¦ä¸²æ ¼å¼
```

**è§£æ±ºæ–¹æ³•**: éœ€è¦ä¿®æ”¹æ•¸æ“šç·¨ç¢¼æ–¹å¼

### B. GraphQL Schema ä¸åŒ¹é…
```
éŒ¯èª¤: field 'insert_agentstorage_one' not found
åŸå› : æ¬Šé™é…ç½®å¾Œæ²’æœ‰æ­£ç¢ºé‡è¼‰
```

**è§£æ±ºæ–¹æ³•**: é‡å•Ÿ Hasura
```bash
sudo docker restart mythic_graphql
```

### C. æ•¸æ“šåºåˆ—åŒ–å•é¡Œ
```
éŒ¯èª¤: JSON parse error / invalid escape sequence
åŸå› : base64 ç·¨ç¢¼æœ‰å•é¡Œ
```

**è§£æ±ºæ–¹æ³•**: ä¿®å¾© serializeNodeData å‡½æ•¸

---

## ğŸ¯ è«‹åŸ·è¡Œä»¥ä¸‹æ“ä½œ

### 1ï¸âƒ£ åˆ·æ–°ç€è¦½å™¨ (ç¡¬åˆ·æ–°)
```
Ctrl + Shift + R
```

### 2ï¸âƒ£ æ‰“é–‹æ§åˆ¶å° (F12)

### 3ï¸âƒ£ å‰µå»ºæ¸¬è©¦ç¯€é»
- Hostname: `TEST`
- IP: `1.1.1.1`
- é»æ“Š CREATE

### 4ï¸âƒ£ æŸ¥çœ‹æ§åˆ¶å°

**è¤‡è£½æ‰€æœ‰ç´…è‰²éŒ¯èª¤æ¶ˆæ¯**ä¸¦å‘Šè¨´æˆ‘ï¼

---

## ğŸ”¬ èª¿è©¦è¼¸å‡º

ç¾åœ¨ä»£ç¢¼å·²ç¶“æ·»åŠ äº†è©³ç´°çš„æ—¥èªŒï¼š
- `[handleCreateCustomNode]` - å‰µå»ºéç¨‹
- `[deserializeNodeData]` - æ•¸æ“šè§£æ
- `[parseAgentStorageResults]` - çµæœè™•ç†
- `[CallbackGraph]` - çµ„ä»¶ç‹€æ…‹

æ‰€æœ‰é€™äº›ä¿¡æ¯éƒ½æœƒåœ¨æ§åˆ¶å°é¡¯ç¤ºã€‚

---

## ğŸ“¸ éœ€è¦çš„ä¿¡æ¯

è«‹æä¾›ï¼š

1. **ç€è¦½å™¨æ§åˆ¶å°çš„å®Œæ•´è¼¸å‡º**ï¼ˆç‰¹åˆ¥æ˜¯ç´…è‰²éŒ¯èª¤ï¼‰
2. **Network æ¨™ç±¤** â†’ GraphQL è«‹æ±‚çš„ Response
3. **æ˜¯å¦çœ‹åˆ°æˆåŠŸæ¶ˆæ¯**ï¼ˆç¶ è‰² snackbarï¼‰

é€™äº›ä¿¡æ¯å°‡å¹«åŠ©æˆ‘å®šä½çœŸæ­£çš„å•é¡Œï¼

---

## ğŸš€ è‡¨æ™‚è§£æ±ºæ–¹æ¡ˆ

å¦‚æœç­‰ä¸åŠèª¿è©¦ï¼Œå¯ä»¥å˜—è©¦ï¼š

1. **é‡å•Ÿ Hasura** (æœ‰æ™‚éœ€è¦å®Œå…¨é‡è¼‰):
```bash
sudo docker restart mythic_graphql
sleep 10
```

2. **é‡æ–°é‹è¡Œé…ç½®è…³æœ¬**:
```bash
cd /home/red/Mythic/MythicReactUI
./configure-hasura-agentstorage.sh
```

3. **æ¸…é™¤ç€è¦½å™¨ç·©å­˜ä¸¦ç¡¬åˆ·æ–°**

---

**è«‹å…ˆåŸ·è¡Œä¸Šè¿°æ­¥é©Ÿä¸¦å ±å‘Šæ§åˆ¶å°éŒ¯èª¤ï¼** ğŸ”
